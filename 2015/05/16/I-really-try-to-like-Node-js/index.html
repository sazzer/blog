<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>I really try to like Node.js (Part 1) | The Wrong Language</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I like the idea behind using Node.js for webapp development. I really do. The idea of using a consistent language between both client and server, which therefore means that you are able to share code">
<meta property="og:type" content="article">
<meta property="og:title" content="I really try to like Node.js (Part 1)">
<meta property="og:url" content="https://sazzer.github.io/blog/2015/05/16/I-really-try-to-like-Node-js/index.html">
<meta property="og:site_name" content="The Wrong Language">
<meta property="og:description" content="I like the idea behind using Node.js for webapp development. I really do. The idea of using a consistent language between both client and server, which therefore means that you are able to share code">
<meta property="og:updated_time" content="2016-09-03T13:23:59.656Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="I really try to like Node.js (Part 1)">
<meta name="twitter:description" content="I like the idea behind using Node.js for webapp development. I really do. The idea of using a consistent language between both client and server, which therefore means that you are able to share code">
<meta name="twitter:creator" content="@https://twitter.com/grahamcox82">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href='//fonts.useso.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/blog/css/style.css">
  <link rel="stylesheet" href="/blog/font-awesome/css/font-awesome.min.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-62627767-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/blog/" id="logo"><i class="logo"></i><span class="site-title">The Wrong Language</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        <div class="profile" id="profile-nav">
          <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/blog/avatar.png"><i class="fa fa-caret-down"></i></a>
        </div>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="https://sazzer.github.io/blog"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
      
        <td><a class="main-nav-link" href="/blog/">Home</a></td>
      
        <td><a class="main-nav-link" href="/blog/archives">Archives</a></td>
      
      <td>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="https://sazzer.github.io/blog"></form>
      </td>
      </tr>
    </table>
  </div>
  
</header>

    <div class="outer">
      <aside id="profile">
  <div class="inner profile-inner">
  	<div class="base-info profile-block">
		  <img id="avatar" src="/blog/avatar.png">
      <h2 id="name">Graham Cox</h2>
      <h3 id="title">Software Developer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Sheffield, England</span>
      <a id="follow" href="https://twitter.com/grahamcox82">FOLLOW</a>
  	</div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        18
        <span>posts</span>
      </div>
      <div class="article-info-block">
        28
        <span>tags</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
        
          <td><a href="http://github.com/sazzer" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
        
          <td><a href="https://twitter.com/grahamcox82" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
        
          <td><a href="/blog/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
        
        </tr>
      </table>
    </div>
    
  </div>
</aside>
      <section id="main"><article id="post-I-really-try-to-like-Node-js" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      I really try to like Node.js (Part 1)
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/blog/2015/05/16/I-really-try-to-like-Node-js/">
    <time datetime="2015-05-16T09:45:14.000Z" itemprop="datePublished">2015-05-16</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/blog/categories/programming/">programming</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I like the idea behind using Node.js for webapp development. I really do. The idea of using a consistent language between both client and server, which therefore means that you are able to share code between the two without replication. Who wouldn’t like that?</p>
<a id="more"></a>
<p>The problem is, I’m spoilt. I’m a Java Enterprise developer by trade, so I come into personal projects with a lot of expectations, simply because it’s what I would want to do at work. I try my best to relax these, but sometimes it’s just going too far. Specifically, a subset of the expectations that I want when doing my projects would be:</p>
<ul>
<li>Good test support<ul>
<li>Including Unit tests, Integration tests and Verification tests</li>
</ul>
</li>
<li>Code coverage</li>
<li>Static analysis<ul>
<li>To an extent, this includes compile time checks</li>
</ul>
</li>
<li>Documentation support</li>
</ul>
<p>Now, a lot of this you can get in Node. Of course, me being me I then further complicate things and make it hard to get some of these. (I’ve taken a real liking to ES6 instead of ES5, but because ES6 is best supported by Transpiling with something like <a href="https://babeljs.io/" target="_blank" rel="external">Babel</a> or <a href="https://github.com/google/traceur-compiler" target="_blank" rel="external">Traceur</a>, it means that the code that you run isn’t the code that you write. That in turn makes code coverage essentially pointless.)</p>
<p>Documentation of your code in Node is easy enough. There’s a fair few projects that will cover this for you, including the one that I’ve been using - <a href="https://esdoc.org/" target="_blank" rel="external">esdoc</a> - that supports ES6 constructs. To be fair, any language that didn’t allow you to document your code would be a real non-starter.</p>
<p>Static analysis of Javascript has a few different alternatives. On the one hand, with ES5 code you have tools like <a href="http://jshint.com/" target="_blank" rel="external">jshint</a>. On the other hand, because I’ve been working with ES6 code then the transpiler does a level of this automatically so that’s not a problem.</p>
<p>Code coverage is possible in Node, but as I say when working with ES6 code it’s relatively pointless. You want to know how much of the code that you wrote was tested, not how much of the code that was generated by the transpiler. However, for people who want to do this there are tools like <a href="http://blanketjs.org/" target="_blank" rel="external">blanket</a> and <a href="https://github.com/gotwarlost/istanbul" target="_blank" rel="external">instanbul</a>.</p>
<p>And of course, Node has a large number of libraries for testing your code. I’ve been a fan of <a href="http://mochajs.org/" target="_blank" rel="external">Mocha</a> + <a href="http://chaijs.com/" target="_blank" rel="external">Chai</a>, but there are plenty of others to choose from as well, both for the actual test harness and for the assertions. That’s not the problem at all.</p>
<p>This is where my problems start. When you write Unit Tests - as opposed to Integration Tests - then the idea is that you test one single Unit in isolation. This typically means that whenever your unit has external dependencies then you replace them with something that is under your control. This something is a Mock or a Stub. Now, there are ways of doing this in Node. In particular, I’ve been using <a href="http://sinonjs.org/" target="_blank" rel="external">Sinon</a> as a Mocking library because it actually gives very good support for creating mocks and stubs, as well as what it calls spies, and lets you confirm that you module works as expected.</p>
<p>The rub is getting these mocks into your code. The ES6 module system encourages you to have modules that include public (i.e. exported) and private components, and that depend directly on the public parts of other modules. There’s no need for any kind of Dependency Injection system with all of this, because you just depend on the modules in question and tie things together that way. And for writing the code itself, that works really well. The problem is that for testing your code this is a complete nightmare. Working this way, you would need some way of overriding the dependencies that are pulled in to your modules after they have loaded. Now, there are modules for traditional ES5 Node that allow you to do this - e.g. <a href="https://github.com/jhnns/rewire" target="_blank" rel="external">Rewire</a> - but they all feel a bit hacky, and they fall down quite badly when you start trying to do ES6 node instead. Rewire requires that you use it instead of the built in ‘require’ statement, which in ES6 you don’t use (At least not directly. Babel re-writes the import statements to be require statements for you). <a href="https://github.com/mfncooper/mockery" target="_blank" rel="external">Mockery</a>, on the other hand, breaks in on the Node module loading system, but you need to have set it up <em>before</em> the appropriate require calls are made, which you can’t do in ES6 since the import statements must be top level.</p>
<p>And so, you end up with lots of units of code that you just don’t bother to test, because you can’t be bothered to work out how to get around this problem. And that in turn means that your code is a bit brittle to change, because you don’t have the coverage necessary to know that things still work when you change it. And then that leads to code that you’re scared of changing, which means that it ends up just as a mess. My latest project is only 17 files large - I’ve barely started - and it’s already feeling messy and out of control because of this.</p>
<p>And that sucks, because on the face of it I like Node.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sazzer.github.io/blog/blog/2015/05/16/I-really-try-to-like-Node-js/" data-id="cisn813vz000c6lg5xu2rzwrc" class="article-share-link">Share</a>
      
        <a href="https://sazzer.github.io/blog/blog/2015/05/16/I-really-try-to-like-Node-js/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/nodejs/">nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/rant/">rant</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2015/06/13/Deploying-your-Maven-Site-to-S3-using-Travis/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Deploying your Maven Site to S3 using Travis
        
      </div>
    </a>
  
  
    <a href="/blog/2015/05/12/Javascript-modules-ES5-vs-ES6/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Javascript modules - ES5 vs ES6</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recents</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/09/03/OpenID-Connect-Response-Types/" class="title">OpenID Connect Response Types</a></p>
              <p class="item-date"><time datetime="2016-09-03T12:40:28.000Z" itemprop="datePublished">2016-09-03</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/05/29/TDD-with-Static-Typed-Languages/" class="title">TDD with Static Typed Languages</a></p>
              <p class="item-date"><time datetime="2016-05-29T14:12:50.000Z" itemprop="datePublished">2016-05-29</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/05/08/I-disagree-with-HATEOAS/" class="title">I disagree with HATEOAS</a></p>
              <p class="item-date"><time datetime="2016-05-08T10:22:01.000Z" itemprop="datePublished">2016-05-08</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/05/07/Designing-a-GraphQL-API/" class="title">Designing a GraphQL API</a></p>
              <p class="item-date"><time datetime="2016-05-07T09:09:59.000Z" itemprop="datePublished">2016-05-07</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/05/06/I-don-t-like-Relay/" class="title">I don&#39;t like Relay</a></p>
              <p class="item-date"><time datetime="2016-05-06T17:48:49.000Z" itemprop="datePublished">2016-05-06</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/blog/">blog</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/buildsystems/">buildsystems</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/programming/">programming</a><span class="category-list-count">12</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/HATEOAS/" style="font-size: 10px;">HATEOAS</a> <a href="/blog/tags/REST/" style="font-size: 10px;">REST</a> <a href="/blog/tags/TDD/" style="font-size: 10px;">TDD</a> <a href="/blog/tags/ajax/" style="font-size: 10px;">ajax</a> <a href="/blog/tags/api/" style="font-size: 20px;">api</a> <a href="/blog/tags/cors/" style="font-size: 10px;">cors</a> <a href="/blog/tags/es5/" style="font-size: 10px;">es5</a> <a href="/blog/tags/es6/" style="font-size: 15px;">es6</a> <a href="/blog/tags/github/" style="font-size: 10px;">github</a> <a href="/blog/tags/graphql/" style="font-size: 17.5px;">graphql</a> <a href="/blog/tags/grunt/" style="font-size: 15px;">grunt</a> <a href="/blog/tags/hexo/" style="font-size: 12.5px;">hexo</a> <a href="/blog/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/blog/tags/mocha/" style="font-size: 10px;">mocha</a> <a href="/blog/tags/mockery/" style="font-size: 10px;">mockery</a> <a href="/blog/tags/mocks/" style="font-size: 10px;">mocks</a> <a href="/blog/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/blog/tags/nodejs/" style="font-size: 20px;">nodejs</a> <a href="/blog/tags/oauth2/" style="font-size: 10px;">oauth2</a> <a href="/blog/tags/oidc/" style="font-size: 10px;">oidc</a> <a href="/blog/tags/openid/" style="font-size: 10px;">openid</a> <a href="/blog/tags/openid-connect/" style="font-size: 10px;">openid connect</a> <a href="/blog/tags/rant/" style="font-size: 10px;">rant</a> <a href="/blog/tags/relay/" style="font-size: 15px;">relay</a> <a href="/blog/tags/s3/" style="font-size: 10px;">s3</a> <a href="/blog/tags/testing/" style="font-size: 15px;">testing</a> <a href="/blog/tags/travisci/" style="font-size: 12.5px;">travisci</a> <a href="/blog/tags/webdev/" style="font-size: 10px;">webdev</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/05/">May 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/01/">January 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/10/">October 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/08/">August 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/07/">July 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/06/">June 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/05/">May 2015</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Graham Cox<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script>
  var disqus_shortname = 'thewronglanguage';
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//code.jquery.com/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>

  </div>
</body>
</html>