<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Deploying your Maven Site to S3 using Travis | The Wrong Language</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Assuming you’ve got a Maven Build, and you’ve got a correctly configured Site for your build, and then further assuming that you are using the Travis CI system for your Continuous Integration (It’s fr">
<meta property="og:type" content="article">
<meta property="og:title" content="Deploying your Maven Site to S3 using Travis">
<meta property="og:url" content="https://sazzer.github.io/blog/2015/06/13/Deploying-your-Maven-Site-to-S3-using-Travis/index.html">
<meta property="og:site_name" content="The Wrong Language">
<meta property="og:description" content="Assuming you’ve got a Maven Build, and you’ve got a correctly configured Site for your build, and then further assuming that you are using the Travis CI system for your Continuous Integration (It’s fr">
<meta property="og:updated_time" content="2016-09-03T13:23:59.656Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Deploying your Maven Site to S3 using Travis">
<meta name="twitter:description" content="Assuming you’ve got a Maven Build, and you’ve got a correctly configured Site for your build, and then further assuming that you are using the Travis CI system for your Continuous Integration (It’s fr">
<meta name="twitter:creator" content="@https://twitter.com/grahamcox82">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href='//fonts.useso.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
  <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/blog/css/style.css">
  <link rel="stylesheet" href="/blog/font-awesome/css/font-awesome.min.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-62627767-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/blog/" id="logo"><i class="logo"></i><span class="site-title">The Wrong Language</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        <div class="profile" id="profile-nav">
          <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/blog/avatar.png"><i class="fa fa-caret-down"></i></a>
        </div>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="https://sazzer.github.io/blog"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
      
        <td><a class="main-nav-link" href="/blog/">Home</a></td>
      
        <td><a class="main-nav-link" href="/blog/archives">Archives</a></td>
      
      <td>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="https://sazzer.github.io/blog"></form>
      </td>
      </tr>
    </table>
  </div>
  
</header>

    <div class="outer">
      <aside id="profile">
  <div class="inner profile-inner">
  	<div class="base-info profile-block">
		  <img id="avatar" src="/blog/avatar.png">
      <h2 id="name">Graham Cox</h2>
      <h3 id="title">Software Developer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Sheffield, England</span>
      <a id="follow" href="https://twitter.com/grahamcox82">FOLLOW</a>
  	</div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        18
        <span>posts</span>
      </div>
      <div class="article-info-block">
        28
        <span>tags</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
        
          <td><a href="http://github.com/sazzer" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
        
          <td><a href="https://twitter.com/grahamcox82" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
        
          <td><a href="/blog/atom.xml" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
        
        </tr>
      </table>
    </div>
    
  </div>
</aside>
      <section id="main"><article id="post-Deploying-your-Maven-Site-to-S3-using-Travis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Deploying your Maven Site to S3 using Travis
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/blog/2015/06/13/Deploying-your-Maven-Site-to-S3-using-Travis/">
    <time datetime="2015-06-13T10:16:51.000Z" itemprop="datePublished">2015-06-13</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/blog/categories/buildsystems/">buildsystems</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Assuming you’ve got a Maven Build, and you’ve got a correctly configured Site for your build, and then further assuming that you are using the <a href="https://travis-ci.org/" target="_blank" rel="external">Travis CI</a> system for your Continuous Integration (It’s free, so why not), one potential next step is to automatically deploy your Maven Site somewhere.</p>
<a id="more"></a>
<p>This writeup shows how to publish your site to S3, and configure S3 to make it publicly accessable. There are plenty of other options out there, but S3 works well enough and turns out to be trivial to set up. All you need to make this work is:</p>
<ul>
<li>An AWS S3 Account</li>
<li>An S3 Bucket already set up</li>
<li>An AWS Access Key and Secret that can write to the bucket.</li>
</ul>
<p>If we’ve got those things then we’re good to go.</p>
<p>Firstly, we need to configure the maven build to be able to deploy to S3. I’ve done this using the <a href="https://github.com/jcaddel/maven-s3-wagon" target="_blank" rel="external">maven-s3-wagon</a> because it just works. The configuration that you need is twofold.</p>
<p>In the <em>build</em> section of your <em>pom.xml</em> file, you need to add the following. This makes it possible to use the S3 Wagon to upload your site.<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">extensions</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">extension</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.kuali.maven.wagons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-s3-wagon<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">extension</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">extensions</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>Then, in your <em>distributionManagement</em> section of your <em>pom.xml</em> file, you need to add something like the following:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">site</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>s3.site<span class="tag">&lt;/<span class="name">id</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>s3://<span class="tag">&lt;<span class="name">S3</span> <span class="attr">Bucket</span> <span class="attr">Name</span>&gt;</span>/<span class="tag">&lt;<span class="name">Site</span> <span class="attr">Path</span>&gt;</span><span class="tag">&lt;/<span class="name">url</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">site</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>The S3 Bucket Name is literally the name of the bucket that you’ve configured in S3 - for example, I’ve used “grahamcox.co.uk” for mine. The Site Path is some directory path under this bucket that you want to deploy the site - for example, you might use something like “${project.artifactId}/${project.version}/site” to keep all of your sites under a directory that is both Artifact and Version specific. This has benefits that when you release later versions of your site, you get to keep all of the old sites, including all of your javadoc and everything, so that people can refer back to it. The path that you deploy under is completely up to you of course.</p>
<p>Once you’ve updated the pom file as above, you are now ready to actually deploy the site. You can test this by running <em>mvn site:deploy</em> by hand - and if you do this it will likely fail due to not having any authentication credentials available. This is the next step.</p>
<p>The Maven Plugin has documentation on how to configure authentication for S3 available at <a href="https://github.com/jcaddel/maven-s3-wagon/wiki/Authentication" target="_blank" rel="external">https://github.com/jcaddel/maven-s3-wagon/wiki/Authentication</a>. This is work a read just to make sure you understand what’s happening, and you can also set it up locally to do a test deploy to make sure you’re happy with the deployment.</p>
<p>The way that I configured Travis to do this is using the Environment Variables, and specifically I used encrypted ones so that my AWS Key and Secret aren’t just available on the internet in plaintext for anyone to see.</p>
<p>To do this, you first need to install the <a href="https://github.com/travis-ci/travis.rb" target="_blank" rel="external">Travis CLI tools</a>. These are well documented on the Github page at <a href="https://github.com/travis-ci/travis.rb#installation" target="_blank" rel="external">https://github.com/travis-ci/travis.rb#installation</a>, but in short you do:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ sudo gem install travis</div><div class="line">.....</div><div class="line">$ travis login</div><div class="line">.....</div><div class="line">$</div></pre></td></tr></table></figure></p>
<p>And then you’re good to go. Once these are available, you can configure Travis to depoy your site.</p>
<p>First, tell Travis about your AWS Keys. This is done as follows:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ travis encrypt --add env.glocal AWS_ACCESS_KEY_ID=abcdef AWS_SECRET_KEY=123456</div></pre></td></tr></table></figure></p>
<p>Where the Access Key is “abcdef” and the Secret Key is “123456”. (These are made up. Don’t try them. They won’t work).</p>
<p>This adds a new Encrypted setting to the Travis Build to make the Environment Variables AWS_ACCESS_KEY_ID and AWS_SECRET_KEY available throughout the build.</p>
<p>Secondly, tell travis to do a site deploy. I did this as follows, in my .travis.yml file<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="attr">language:</span> java</div><div class="line"><span class="attr">jdk:</span></div><div class="line"><span class="bullet">    -</span> oraclejdk8</div><div class="line"><span class="attr">install:</span> mvn clean install -P-quality-checks -DskipTests</div><div class="line"><span class="attr">script:</span></div><div class="line"><span class="bullet">    -</span> mvn install</div><div class="line"><span class="attr">after_script:</span> mvn site site:deploy</div></pre></td></tr></table></figure></p>
<p>Note that my build does not run tests or quality checks (PMD, FindBugs, Checkstyle, etc) as part of the Install phase, but does that all later on in the Script phase. I then do the site deploy after the script phase has run, whether the build was successful or not. This means that if I break the build, my site still gets deployed and tells me what my errors are. (In theory. I’ve not tested that yet)</p>
<p>Once all of this is done, you can now visit the Site deployed in S3 and marvel at it’s beauty.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sazzer.github.io/blog/blog/2015/06/13/Deploying-your-Maven-Site-to-S3-using-Travis/" data-id="cisn813v600016lg5b65eiusn" class="article-share-link">Share</a>
      
        <a href="https://sazzer.github.io/blog/blog/2015/06/13/Deploying-your-Maven-Site-to-S3-using-Travis/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/s3/">s3</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/travisci/">travisci</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2015/07/18/Optimistic-Locking-in-MongoDB/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Optimistic Locking in MongoDB
        
      </div>
    </a>
  
  
    <a href="/blog/2015/05/16/I-really-try-to-like-Node-js/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">I really try to like Node.js (Part 1)</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recents</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/09/03/OpenID-Connect-Response-Types/" class="title">OpenID Connect Response Types</a></p>
              <p class="item-date"><time datetime="2016-09-03T12:40:28.000Z" itemprop="datePublished">2016-09-03</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/05/29/TDD-with-Static-Typed-Languages/" class="title">TDD with Static Typed Languages</a></p>
              <p class="item-date"><time datetime="2016-05-29T14:12:50.000Z" itemprop="datePublished">2016-05-29</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/05/08/I-disagree-with-HATEOAS/" class="title">I disagree with HATEOAS</a></p>
              <p class="item-date"><time datetime="2016-05-08T10:22:01.000Z" itemprop="datePublished">2016-05-08</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/05/07/Designing-a-GraphQL-API/" class="title">Designing a GraphQL API</a></p>
              <p class="item-date"><time datetime="2016-05-07T09:09:59.000Z" itemprop="datePublished">2016-05-07</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/blog/categories/programming/">programming</a></p>
              <p class="item-title"><a href="/blog/2016/05/06/I-don-t-like-Relay/" class="title">I don&#39;t like Relay</a></p>
              <p class="item-date"><time datetime="2016-05-06T17:48:49.000Z" itemprop="datePublished">2016-05-06</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/blog/">blog</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/buildsystems/">buildsystems</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/programming/">programming</a><span class="category-list-count">12</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">tag cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/HATEOAS/" style="font-size: 10px;">HATEOAS</a> <a href="/blog/tags/REST/" style="font-size: 10px;">REST</a> <a href="/blog/tags/TDD/" style="font-size: 10px;">TDD</a> <a href="/blog/tags/ajax/" style="font-size: 10px;">ajax</a> <a href="/blog/tags/api/" style="font-size: 20px;">api</a> <a href="/blog/tags/cors/" style="font-size: 10px;">cors</a> <a href="/blog/tags/es5/" style="font-size: 10px;">es5</a> <a href="/blog/tags/es6/" style="font-size: 15px;">es6</a> <a href="/blog/tags/github/" style="font-size: 10px;">github</a> <a href="/blog/tags/graphql/" style="font-size: 17.5px;">graphql</a> <a href="/blog/tags/grunt/" style="font-size: 15px;">grunt</a> <a href="/blog/tags/hexo/" style="font-size: 12.5px;">hexo</a> <a href="/blog/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/blog/tags/mocha/" style="font-size: 10px;">mocha</a> <a href="/blog/tags/mockery/" style="font-size: 10px;">mockery</a> <a href="/blog/tags/mocks/" style="font-size: 10px;">mocks</a> <a href="/blog/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/blog/tags/nodejs/" style="font-size: 20px;">nodejs</a> <a href="/blog/tags/oauth2/" style="font-size: 10px;">oauth2</a> <a href="/blog/tags/oidc/" style="font-size: 10px;">oidc</a> <a href="/blog/tags/openid/" style="font-size: 10px;">openid</a> <a href="/blog/tags/openid-connect/" style="font-size: 10px;">openid connect</a> <a href="/blog/tags/rant/" style="font-size: 10px;">rant</a> <a href="/blog/tags/relay/" style="font-size: 15px;">relay</a> <a href="/blog/tags/s3/" style="font-size: 10px;">s3</a> <a href="/blog/tags/testing/" style="font-size: 15px;">testing</a> <a href="/blog/tags/travisci/" style="font-size: 12.5px;">travisci</a> <a href="/blog/tags/webdev/" style="font-size: 10px;">webdev</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/05/">May 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2016/01/">January 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/10/">October 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/08/">August 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/07/">July 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/06/">June 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2015/05/">May 2015</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Graham Cox<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script>
  var disqus_shortname = 'thewronglanguage';
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//code.jquery.com/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>

  </div>
</body>
</html>